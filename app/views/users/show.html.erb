<div class="user-profile-page">
  <div class="profile-sections">
    <div class="user-page">
      <div class="profile-info">
        <div class="user-profile">
          <%#--Shows that this is YOUR profile page if it's yours %>
          <% if @user == current_user %>
          <h3>Your Dished Profile</h3>
          <div class="avatar-username">
            <%= image_tag "https://kitt.lewagon.com/placeholder/users/ssaunier", class: "avatar" %>
            Username: <%= @user.username %>
          </div>


          <%#-- Otherwise shows the username %>
          <% else %>
          Profile:  <%= @user.username %>
          <% end %>
        </div>


        <div class="followings">
          <%#-- Shows who you are following %>
          <% if @user.follows_given.empty? %>
            Not following anyone
          <% else %>
            Following:
            <%= @user.follows_given.count%>
            <br>
            <% @user.follows_given.each do |following| %>
              <%= link_to following.followee.username, user_path(following.followee) %><br>
              <% end %>
          <% end %>

          <br>
          <%#-- Shows who follows you %>
          <% if @user.follows_received.empty? %>
            No followers
          <% else %>
            Followed by:
            <%= @user.follows_received.count %>
            <br>
            <% @user.follows_received.each do |following| %>
              <%= link_to following.follower.username, user_path(following.follower) %>
            <% end %>
          <% end %>
          <%#-- Link to users index %>
          <br>
          <%= link_to "Find foodie friends", users_path %>
          <br>
          <%#-- Follow / Unfollow logic %>
          <% if current_user != @user && !current_user.follows_given.pluck(:followee_id).include?(@user.id) %>
            <%= link_to "Follow this foodie", follow_user_path(@user), method: :post %>
          <% elsif current_user != @user  %>
            <%= link_to "Unfollow this foodie", unfollow_user_path(@user), method: :delete %>
          <% end %>
        </div>
      </div>


      <div class="recipe-links">
          <%= link_to 'Back to recipes', recipes_path %>
          <%= link_to 'Upload a new recipe', new_recipe_path %>
      </div>
    </div>



    <%#-- Show each bookmark... this needs to be turned into a card %>
    <div class="cookbook">
      Your Cookbook
      <div class="cookbook-content">
        <!-- to be replaced by index card once created -->
        <div class="row">
          <% @user.bookmarks.each do |bookmark| %>
            <div class="col-4">
              <div class="recipe-index-card">
                <%=cl_image_tag bookmark.recipe.photo.key, height: 200, width: 300, crop: :fill  %>
                <br>
                <%= link_to bookmark.recipe.name, recipe_path(bookmark.recipe.id)  %>
                <p><%= bookmark.recipe.description %></p>
                <p><%= bookmark.recipe.meal %></p>
                <p><%= bookmark.recipe.cuisine %></p>
                <p>Serves: <%= bookmark.recipe.serves %></p>
                <p>Cook time: <%= bookmark.recipe.cook_time %></p>
                  <% unless @user.id == bookmark.recipe.user.id %>
                      <p><%= link_to "Chef's Profile", user_path(bookmark.recipe.user.id) %></p>
                  <% end %>
              </div>
            </div>
          <% end %>
        </div>

      </div>


    </div>
  </div>

</div>

